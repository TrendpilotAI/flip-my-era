<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Image Load</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .status {
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background: white;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow: auto;
            max-height: 400px;
        }
    </style>
</head>
<body>
    <h1>Testing Image Data Load</h1>
    
    <div id="status" class="status">Checking files...</div>
    
    <h2>Data Summary:</h2>
    <div id="summary"></div>
    
    <h2>Sample Data:</h2>
    <pre id="sample"></pre>
    
    <script>
        async function testLoad() {
            const status = document.getElementById('status');
            const summary = document.getElementById('summary');
            const sample = document.getElementById('sample');
            
            try {
                // Test load the JSON file
                status.textContent = 'Loading JSON file...';
                const response = await fetch('./src/modules/story/data/generatedImagesLocal.json');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                status.textContent = 'Parsing JSON...';
                const data = await response.json();
                
                // Check structure
                if (!data.heroGallery || !data.eras || !data.prompts) {
                    throw new Error('Missing required sections in JSON');
                }
                
                // Calculate stats
                const stats = {
                    heroGallery: data.heroGallery ? data.heroGallery.length : 0,
                    eras: data.eras ? data.eras.length : 0,
                    prompts: data.prompts ? data.prompts.length : 0,
                    totalImages: 0
                };
                
                // Count total images
                ['heroGallery', 'eras', 'prompts'].forEach(section => {
                    if (data[section]) {
                        data[section].forEach(item => {
                            if (item.variations) {
                                stats.totalImages += item.variations.length;
                            }
                        });
                    }
                });
                
                status.className = 'status success';
                status.textContent = '✅ Successfully loaded image data!';
                
                summary.innerHTML = `
                    <ul>
                        <li>Hero Gallery: ${stats.heroGallery} items</li>
                        <li>Eras: ${stats.eras} items</li>
                        <li>Story Prompts: ${stats.prompts} items</li>
                        <li>Total Images: ${stats.totalImages}</li>
                    </ul>
                    <p><a href="image-manager-ultimate.html">Open Image Manager Ultimate</a></p>
                `;
                
                // Show sample data
                const sampleData = {
                    firstHero: data.heroGallery[0],
                    firstEra: data.eras[0],
                    firstPrompt: data.prompts[0]
                };
                
                sample.textContent = JSON.stringify(sampleData, null, 2);
                
            } catch (error) {
                status.className = 'status error';
                status.textContent = '❌ Error: ' + error.message;
                console.error('Load error:', error);
            }
        }
        
        // Run test on page load
        testLoad();
    </script>
</body>
</html>
